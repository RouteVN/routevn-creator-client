elementName: rvn-command-line-visual

viewDataSchema:
  type: object
  properties: {}

propsSchema:
  type: object
  properties:
    visual:
      type: object
      properties:
        items:
          type: array
    presentationState:
      type: object

refs:
  add-visual-button:
    eventListeners:
      click:
        handler: handleAddVisualClick
  remove-visual-*:
    eventListeners:
      click:
        handler: handleRemoveVisualClick
  visual-*:
    eventListeners:
      click:
        handler: handleVisualClick
      contextmenu:
        handler: handleVisualContextMenu
  resource-item-*:
    eventListeners:
      click:
        handler: handleResourceItemClick
  submit-button:
    eventListeners:
      click:
        handler: handleSubmitClick
  breadcumb:
    eventListeners:
      item-click:
        handler: handleBreadcumbClick
  button-select:
    eventListeners:
      click:
        handler: handleButtonSelectClick
  dropdown-menu:
    eventListeners:
      close:
        handler: handleDropdownMenuClose
      click-item:
        handler: handleDropdownMenuClickItem
  transform-*:
    eventListeners:
      option-selected:
        handler: handleTransformChange

template:
  - rtgl-view w=f h=f p=lg:
      - $if mode == 'current':
          - rtgl-view d=h g=md:
              - rtgl-breadcrumb#breadcumb .items=breadcrumb:
          - rtgl-view flex=1 sv w=f:
              - rtgl-view g=md w=f:
                  - $for visual, i in defaultValues.visuals:
                      - rtgl-view#visual-${visual.id}-${i} d=h g=md av=t bgc=ac p=md br=md w=f:
                          - rtgl-view g=sm:
                              - $if visual.fileId:
                                  - rvn-file-image fileId=${visual.fileId} w=120 h=120 br=sm:
                                $else:
                                  - rtgl-view w=120 h=120 av=c ah=c bgc=mu br=sm cur=p:
                                      - rtgl-text s=sm c=mu-fg: No Resource
                              - rtgl-text s=sm w=120 ah=c ellipsis=true: ${visual.displayName}
                              - $if visual.resourceType:
                                  - rtgl-text s=xs c=mu-fg ah=c: (${visual.resourceType})
                          - rtgl-view flex=1 g=sm:
                              - rtgl-text s=sm c=mu-fg: Transform
                              - rtgl-select#transform-${i} .options=defaultValues.transformOptions .selectedValue=defaultValues.visuals[${i}].transformId w=f:
                  - rtgl-button#add-visual-button v=ol w=f mt=md: + Add Visual

          - rtgl-view d=h av=c ah=e w=f g=lg:
              - rtgl-button#submit-button: Submit

      - $if mode == 'resource-select':
          - rtgl-view d=h g=md:
              - rtgl-breadcrumb#breadcumb .items=breadcrumb:
          - 'rtgl-view d=h w=f g=lg flex=1 style="min-height: 0;"':
              - rtgl-view h=f flex=1 sv g=lg:
                  - $for group, i in resourceGroups:
                      - rtgl-view g=md:
                          - rtgl-text: ${group.name}
                          - rtgl-view d=h w=f fw=w g=lg:
                              - $for item, j in group.children:
                                  - rtgl-view#resource-item-${item.id} w=200 h=150 cur=p key=${item.bw} bw=${item.bw} bc=pr br=sm g=sm:
                                      - $if item.previewFileId:
                                          - rvn-file-image fileId=${item.previewFileId} w=200 h=120:
                                        $else:
                                          - rtgl-view w=200 h=120 bgc=mu av=c ah=c:
                                              - rtgl-text s=sm c=mu-fg: ${item.resourceType}
                                      - rtgl-text s=sm ah=c ellipsis=true: ${item.name}
          - rtgl-view d=h av=c ah=e w=f g=lg:
              - rtgl-button#button-select: Select

  - rtgl-dropdown-menu#dropdown-menu .items=dropdownMenu.items x=${dropdownMenu.position.x} y=${dropdownMenu.position.y} ?open=${dropdownMenu.isOpen}:
