elementName: rvn-command-line-background

viewDataSchema:
  type: object
  properties: {}

propsSchema:
  type: object
  properties:
    line:
      type: object
      properties:
        imageId:
          type: string
        layoutId:
          type: string
        videoId:
          type: string

refs:
  background-selector:
    eventListeners:
      click:
        handler: handleBackgroundSelectorClick
  rvn-image-selector:
    eventListeners:
      image-selected:
        handler: handleImageSelected
  layout-item-*:
    eventListeners:
      click:
        handler: handleLayoutItemClick
  submit-button:
    eventListeners:
      click:
        handler: handleSubmitClick
  breadcumb-actions:
    eventListeners:
      click:
        handler: handleBreadcumbActionsClick
  breadcumb-background:
    eventListeners:
      click:
        handler: handleBreadcumbBackgroundClick
  button-select:
    eventListeners:
      click:
        handler: handleButtonSelectClick
  tab-images:
    eventListeners:
      click:
        handler: handleTabClick
  tab-layouts:
    eventListeners:
      click:
        handler: handleTabClick
  tab-videos:
    eventListeners:
      click:
        handler: handleTabClick
  video-item-*:
    eventListeners:
      click:
        handler: handleVideoItemClick

template:
  - rtgl-view w=f h=f p=lg:
    - $if mode == 'current':
      - rtgl-view d=h g=md:
        - rtgl-text#breadcumb-actions s=sm c=mu-fg mb=lg cur=p: Actions
        - rtgl-text s=sm c=mu-fg mb=lg: '>'
        - rtgl-text s=sm c=mu-fg mb=lg: Background
      - rtgl-text: Background Selection
      - $if tab == 'images':
          - $if selectedImageId:
              - rvn-file-image#background-selector imageId=${selectedImageId} w=345 h=200:
            $else:
              - rtgl-view#background-selector w=345 h=200 av=c ah=c bgc=ac cur=p:
                - rtgl-text: Select Image
        $elif tab == 'layouts':
          - $if selectedLayoutId:
              - rtgl-view#background-selector w=345 h=200 av=c ah=c bgc=ac cur=p:
                - rtgl-text: ${selectedName}
            $else:
              - rtgl-view#background-selector w=345 h=200 av=c ah=c bgc=ac cur=p:
                - rtgl-text: Select Layout
        $elif tab == 'videos':
          - $if selectedVideoId:
              - rvn-file-video#background-selector videoId=${selectedVideoId} w=345 h=200:
            $else:
              - rtgl-view#background-selector w=345 h=200 av=c ah=c bgc=ac cur=p:
                - rtgl-text: Select Video
      - $if tab == 'layouts':
          - rtgl-view:
            - rtgl-text: Select Position
            - rtgl-select .options=positionOptions:
      - rtgl-view flex=1:
      - rtgl-view d=h av=c ah=e w=f g=lg:
        - rtgl-button#reset-button v=ol: Reset
        - rtgl-button#submit-button: Submit

    - $if mode == 'gallery':
      - rtgl-view d=h g=md:
        - rtgl-text#breadcumb-actions s=sm c=mu-fg mb=lg cur=p: Actions
        - rtgl-text s=sm c=mu-fg mb=lg: '>'
        - rtgl-text#breadcumb-background s=sm c=mu-fg mb=lg cur=p: Background
        - rtgl-text s=sm c=mu-fg mb=lg: '>'
        - $if tab == 'images':
            - rtgl-text s=sm c=mu-fg mb=lg: Image Selection
          $elif tab == 'layouts':
            - rtgl-text s=sm c=mu-fg mb=lg: Layout Selection
          $elif tab == 'videos':
            - rtgl-text s=sm c=mu-fg mb=lg: Video Selection
      - rtgl-view d=h g=lg mb=lg:
        - 'rtgl-view#tab-images d=h av=c ah=c px=lg py=sm bgc=${tab == "images" ? "ac" : "mu-bg"} cur=p':
          - 'rtgl-text c=${tab == "images" ? "primary" : "mu-fg"}': Images
        - 'rtgl-view#tab-layouts d=h av=c ah=c px=lg py=sm bgc=${tab == "layouts" ? "ac" : "mu-bg"} cur=p':
          - 'rtgl-text c=${tab == "layouts" ? "primary" : "mu-fg"}': Layouts
        - 'rtgl-view#tab-videos d=h av=c ah=c px=lg py=sm bgc=${tab == "videos" ? "ac" : "mu-bg"} cur=p':
          - 'rtgl-text c=${tab == "videos" ? "primary" : "mu-fg"}': Videos
      - 'rtgl-view d=h w=f g=lg flex=1 style="min-height: 0;"':
        - rtgl-view h=f flex=1 sv:
          - rvn-base-file-explorer#base-file-explorer .items=items:
        - rtgl-view h=f flex=2 sv g=lg:
          - $if tab == 'images':
              - rvn-image-selector .groups=groups .selectedImageId=tempSelectedImageId:
            $elif tab == 'layouts':
              - $for group in groups:
                - rtgl-view g=md:
                  - rtgl-text: ${group.name}
                  - rtgl-view d=h w=f fw=w g=lg:
                    - $for item in group.children:
                      - rtgl-view w=200 h=150 cur=p g=sm:
                        - $if item.filePath:
                            - rvn-file-image#layout-item-${item.id} w=200 h=120 fileId=${item.fileId}:
                          $else:
                            - rtgl-view#layout-item-${item.id} w=200 h=120 av=c ah=c bgc=ac:
                              - rtgl-text s=sm c=mu-fg: Preview
                        - rtgl-text s=sm ah=c: ${item.name}
            $elif tab == 'videos':
              - $for group in groups:
                - rtgl-view g=md:
                  - rtgl-text: ${group.name}
                  - rtgl-view d=h w=f fw=w g=lg:
                    - $for item in group.children:
                      - rtgl-view w=200 h=150 cur=p g=sm:
                        - $if item.filePath:
                            - rvn-file-video#video-item-${item.id} w=200 h=120 fileId=${item.fileId}:
                          $else:
                            - rtgl-view#video-item-${item.id} w=200 h=120 av=c ah=c bgc=ac:
                              - rtgl-text s=sm c=mu-fg: Video Preview
                        - rtgl-text s=sm ah=c: ${item.name}
      - rtgl-view d=h av=c ah=e w=f g=lg:
        - rtgl-button#button-select: Select
