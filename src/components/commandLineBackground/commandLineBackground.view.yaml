elementName: rvn-command-line-background

viewDataSchema:
  type: object
  properties:
    mode:
      type: string
      enum: ["current", "gallery"]
    tab:
      type: string
      enum: ["image", "layout", "video"]
    tabs:
      type: array
      items:
        type: object
        properties:
          id:
            type: string
          label:
            type: string
    breadcrumb:
      type: array
      items:
        type: object
        properties:
          id:
            type: string
          label:
            type: string
    items:
      type: array
    groups:
      type: array
    tempSelectedResourceId:
      type: string
    dialogueForm:
      type: object
      properties:
        form:
          type: object
        defaultValues:
          type: object
          properties:
            background:
              type: string
            animation:
              type: string

propsSchema:
  type: object
  properties:
    background:
      type: object
      properties:
        resourceId:
          type: string
        resourceType:
          type: string
          enum: ["image", "layout", "video"]
        animations:
          type: object
          properties:
            in:
              type: string

refs:
  rvn-image-selector:
    eventListeners:
      image-selected:
        handler: handleImageSelected
  resource-item-*:
    eventListeners:
      click:
        handler: handleResourceItemClick
  submit-button:
    eventListeners:
      click:
        handler: handleSubmitClick
  breadcumb:
    eventListeners:
      item-click:
        handler: handleBreadcumbActionsClick
  button-select:
    eventListeners:
      click:
        handler: handleButtonSelectClick
  tabs:
    eventListeners:
      item-click:
        handler: handleTabClick
  form:
    eventListeners:
      extra-event:
        handler: handleFormExtra
      form-change:
        handler: handleFormInputChange
  background-image:
    eventListeners:
      click:
        handler: handleBackgroundImageClick
      contextmenu:
        handler: handleBackgroundImageRightClick
  base-file-explorer:
    eventListeners:
      click-item:
        handler: handleFileExplorerClickItem

template:
  - rtgl-view w=f h=f p=lg:
      - rtgl-view d=h g=md:
      - rtgl-breadcrumb#breadcumb .items=breadcrumb:
      - $if mode == 'current':
          - rtgl-form#form .form=dialogueForm.form .defaultValues=dialogueForm.defaultValues:
              - $if selectedResource:
                  - $if selectedResource.resourceType == 'image':
                      - rvn-file-image#background-image fileId=${selectedResource.fileId} w=355 h=200 slot=background cur=p:
                    $elif selectedResource.resourceType == 'layout':
                      - rtgl-view#background-image w=355 h=200 bgc=mu av=c ah=c cur=p slot=background bw=xs bc=mu br=sm:
                          - rtgl-view av=c ah=c:
                              - rtgl-text s=lg: ${selectedResource.name}
                              - rtgl-text s=sm c=mu-fg: ${selectedResource.layoutTypeDisplay}
                    $else:
                      - rtgl-view#background-image w=355 h=200 bgc=mu av=c ah=c cur=p slot=background:
                          - rtgl-text s=md c=mu-fg: Select Background
                $else:
                  - rtgl-view#background-image w=355 h=200 bgc=mu av=c ah=c cur=p slot=background:
                      - rtgl-text s=md c=mu-fg: Select Background
          - rtgl-view flex=1:
          - rtgl-view d=h av=c ah=e w=f g=lg:
              - rtgl-button#submit-button: Submit

      - $if mode == 'gallery':
          - rtgl-tabs#tabs selected-tab=${tab} .items=tabs:
          - 'rtgl-view d=h w=f g=lg mt=sm flex=1 style="min-height: 0;"':
              - rtgl-view h=f flex=1 sv:
                  - rvn-base-file-explorer#base-file-explorer .items=items:
              - rtgl-view h=f flex=2 sv g=lg:
                  - $if tab == 'image':
                      - rvn-image-selector#rvn-image-selector:
                    $elif tab == 'layout':
                      - $for group in groups:
                          - rtgl-view g=md:
                              - rtgl-text: ${group.name}
                              - rtgl-view d=h w=f fw=w g=lg:
                                  - $for item in group.children:
                                      - rtgl-view#resource-item-${item.id} w=200 h=150 ah=c av=c bw=${item.bw} bc=${item.bc} br=sm cur=p:
                                          - rtgl-view av=c ah=c:
                                              - rtgl-text s=md: ${item.name}
                                              - rtgl-text s=sm c=mu-fg: ${item.layoutTypeDisplay}
                    $elif tab == 'video':
                      - $for group in groups:
                          - rtgl-view g=md:
                              - rtgl-text: ${group.name}
                              - rtgl-view d=h w=f fw=w g=lg:
                                  - $for item in group.children:
                                      - rtgl-view w=200 h=150 cur=p g=sm:
                                          - rvn-file-image#resource-item-${item.id} w=200 h=120 fileId=${item.thumbnailFileId}:
                                          - rtgl-text s=sm ah=c: ${item.name}
          - rtgl-view d=h av=c ah=e w=f g=lg:
              - rtgl-button#button-select: Select
