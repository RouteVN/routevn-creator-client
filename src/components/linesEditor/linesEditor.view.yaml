elementName: rvn-lines-editor

onMount:
  handler: handleOnMount

viewDataSchema:
  type: object
  properties:
    selectedLineId:
      type: string
    mode:
      type: string

propsSchema:
  type: object
  properties:
    lines:
      type: array
      items:
        type: object
        properties:
    selectedLineId:
      type: string

refs:
  container:
    eventListeners:
      keydown:
        handler: handleContainerKeyDown
  line-*:
    eventListeners:
      focus:
        handler: handleOnFocus
      input:
        handler: handleOnInput
      # mousedown:
      #   handler: handleBlockMouseDown
      mouseup:
        handler: handleLineMouseUp
      # beforeinput:
      #   handler: handleBlockBeforeInput
      # compositionend:
      #   handler: handleBlockCompositionEnd
      # compositionstart:
      #   handler: handleBlockCompositionStart
      keydown:
        handler: handleLineKeyDown

styles:
  'div[contenteditable="true"]:focus':
    outline: none

template:
  - 'rtgl-view#container w=f h=f tabindex=0 style="outline: none;"':
    - $for line, i in lines:
      - 'rtgl-view d=h w=f av=c style="background-color: ${line.backgroundColor};"':
        - rtgl-view h=f av=c w=32 ah=e mr=md:
          - rtgl-text s=sm c=${line.lineColor}: ${line.lineNumber}
        - rtgl-view wh=16 br=f mr=md:
        - rtgl-view d=h w=f av=c:
          - 'div#line-${line.id} style="width: 100%;" contenteditable=true':
            - 'span style="font-size: 18px;"': ${line.instructions.presentationInstructions.dialogue.text}
          - rtgl-view d=h:
            - $if line.backgroundFileId:
              - rvn-file-image w=36 h=24 fileId=${line.backgroundFileId}: 
            # - $else:
            #   - rtgl-view w=36 h=24 bgc=mu av=c ah=c:
            #     - rtgl-text s=xs: No Background
