elementName: rvn-audio-player

attrsSchema:
  type: object
  properties:
    fileId:
      type: string
      description: ID of the audio file to play
    autoPlay:
      type: boolean
      description: Whether to start playing automatically
      default: false

propsSchema:
  type: object
  properties:
    title:
      type: string
      description: Title of the audio player, used for accessibility
      default: "Audio Player"

viewDataSchema:
  type: object
  properties:
    isPlaying:
      type: boolean
    isLoading:
      type: boolean
    currentTime:
      type: number
    duration:
      type: number
    currentTimeFormatted:
      type: string
    durationFormatted:
      type: string
    progressPercentage:
      type: number

refs:
  play-pause-btn:
    eventListeners:
      click:
        handler: handlePlayPause
  progress-bar:
    eventListeners:
      click:
        handler: handleProgressBarClick
  playerCloser:
    eventListeners:
      click:
        handler: handleClose

template:
  - rtgl-view w=f h=f bgc=mu:
      - $if isLoading:
          - rtgl-view w=f av=c p=md h=f:
              - rtgl-text c=mu-fg: Loading audio...
        $else:
          - rtgl-view w=f g=md bgc=mu:
              # Progress bar
              - rtgl-view w=f:
                  - 'rtgl-view#progress-bar w=f h=6 br=full cur=p pos=rel style="overflow: hidden;"':
                      - 'rtgl-view h=f bgc=ac br=full style="width: ${progressPercentage}%; transition: width 0.1s ease;"':

              # Play/Pause button and time display
              - rtgl-view ph=md d=h av=c w=f h=f p=md:
                  - rtgl-text w=250 ellipsis=true: ${title}
                  - rtgl-view d=h av=c g=lg flex=1 ah=c:
                      - rtgl-view#play-pause-btn cur=p:
                          - $if isPlaying:
                              - rtgl-svg wh=32 svg=pause:
                            $else:
                              - rtgl-svg wh=32 svg=play:
                      - rtgl-view d=h av=c g=sm:
                          - rtgl-text s=sm c=mu-fg: ${currentTimeFormatted}
                          - rtgl-text s=sm c=mu-fg: /
                          - rtgl-text s=sm c=mu-fg: ${durationFormatted}
                  - rtgl-svg#playerCloser svg=cross w=24 h=24 cur=p:
