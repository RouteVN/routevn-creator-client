elementName: rvn-group-variables-view

viewDataSchema:
  type: object
  properties:
    searchQuery:
      type: string

propsSchema:
  type: object
  properties:
    flatGroups:
      type: array
      description: Array of variable groups to display
    selectedItemId:
      type: string
      description: ID of currently selected item

refs:
  search-input:
    eventListeners:
      input-change:
        handler: handleSearchInput
  group-*:
    eventListeners:
      click:
        handler: handleGroupClick
  variable-item-*:
    eventListeners:
      click:
        handler: handleVariableItemClick
  add-variable-button-*:
    eventListeners:
      click:
        handler: handleAddVariableClick
  add-variable-dialog:
    eventListeners:
      close:
        handler: handleCloseDialog
  variable-form:
    eventListeners:
      action-click:
        handler: handleFormActionClick
      form-change:
        handler: handleDialogFormChange
  table-*:
    eventListeners:
      row-click:
        handler: handleTableRowClick
  form-enum-add:
    eventListeners:
      click:
        handler: handleEnumAddButtonClick

template:
  - 'rtgl-view w=f h=100vh g=lg style="overflow-y: scroll;"':
      - rtgl-view g=lg w=f h=f:
          - 'rtgl-view h=48 w=f bgc=bg bwb=xs ph=md av=c style="position: sticky; top: 0px; z-index: 1000;"':
              - rtgl-input#search-input s=sm placeholder="Search variables..." value=${searchQuery}:
          - $if flatGroups.length > 0:
              - $for group, i in flatGroups:
                  - rtgl-view w=f ph=md:
                      - 'rtgl-view#group-${group.id} d=h w=f av=c bgc=bg cur=p style="position: sticky; top: 48px;"':
                          - $if group.isCollapsed:
                              - rtgl-svg wh=16 svg=folderArrowRight:
                            $else:
                              - rtgl-svg wh=16 svg=folderArrowDown:
                          - rtgl-view d=h av=c g=md:
                              - rtgl-svg wh=16 svg=folder:
                              - rtgl-text: ${group.fullLabel}
                      - $if !group.isCollapsed:
                          - rtgl-view w=f mb=md p=sm:
                              - rtgl-view d=h g=md fw=w w=f:
                                  - rtgl-table#table-${group.id} .data=flatGroups[${i}].tableData w=f:
                              - rtgl-view#add-variable-button-${group.id} w=f h=60 av=c ah=c bw=xs cur=p mt=md:
                                  - rtgl-text: Add Variable
            $elif searchQuery:
              - rtgl-view w=f h=400 av=c ah=c:
                  - rtgl-text s=lg c=mu-fg: No variables found matching "${searchQuery}"
            $else:
              - rtgl-view w=f h=f av=c ah=c:
                  - rtgl-text s=lg c=mu-fg: No data
                  - rtgl-view h=64:

          - $if flatGroups.length > 0:
              - rtgl-view h=33vh:

  - rtgl-dialog#add-variable-dialog s=md ?open=${isDialogOpen}:
      - rtgl-view slot=content g=md:
          - rtgl-form#variable-form key=${isDialogOpen} .defaultValues=defaultValues .form=form w=f .context=context:
              - rtgl-view slot="enum" g=md w=f:
                  - $for item in defaultValues.enum:
                      - rtgl-view br=md bw=xs h=36 ph=md av=c w=f:
                          - rtgl-text: ${item.label}
                  - rtgl-view d=h g=md w=f:
                      - rtgl-input#form-enum-input w=f:
                      - rtgl-button#form-enum-add: Add