elementName: rvn-detail-panel

propsSchema:
  type: object
  properties:
    title:
      type: string
    fields:
      type: array
      items:
        type: object
        properties:
          type:
            type: string
          editable:
            type: boolean
            description: Whether the field is editable (for images, enables click-to-upload)
    emptyMessage:
      type: string

refs:
  editable-image-*:
    eventListeners:
      click:
        handler: handleEditableImageClick
  file-input-*:
    eventListeners:
      change:
        handler: handleFileInputChange

template:
  - rtgl-view w=f h=f p=md w=270 bwl=xs bc=bo:
    - $if hasContent:
        - $if title:
            - rtgl-text s=lg: ${title}
        - rtgl-view w=f h=f g=md:
          - $for field, i in visibleFields:
              - $if field.type == 'image':
                  - $if field.editable:
                      - rtgl-view pos=rel:
                        - 'rtgl-view#editable-image-${i} cur=p style="position: relative;"':
                          - rvn-file-image br=md w=${field.width} h=${field.height} fileId=${field.fileId}:
                          - 'rtgl-view pos=abs cor=full bgc=rgba(0,0,0,0.5) av=c ah=c style="opacity: 0; transition: opacity 0.2s;" h-style="opacity: 1;"':
                            - rtgl-svg svg=upload wh=24 c=wh:
                        - 'input#file-input-${i} type=file accept="${field.accept}" style="display: none;"':
                    $else:
                      - rvn-file-image br=md w=${field.width} h=${field.height} fileId=${field.fileId}:
                $elif field.type == 'audio':
                  - rvn-audio-player fileId=${field.fileId} autoPlay=${field.autoPlay}:
                $elif field.type == 'text':
                  - rtgl-view:
                    - rtgl-text c=mu-fg: ${field.label}
                    - rtgl-text s=${field.size}: ${field.value}
                $elif field.type == 'color':
                  - rtgl-view:
                    - rtgl-text c=mu-fg: ${field.label}
                    - rtgl-color-picker value={field.value}:
      $else:
        - rtgl-view w=f h=f av=c ah=c:
          - rtgl-text c=mu-fg s=lg ta=c: ${emptyMessage}