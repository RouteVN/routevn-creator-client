refs:
  editableImage*:
    eventListeners:
      click:
        handler: handleEditableImageClick
  fileInput*:
    eventListeners:
      change:
        handler: handleFileInputChange
  editableAudio*:
    eventListeners:
      click:
        handler: handleEditableAudioClick
  titleText*:
    eventListeners:
      click:
        handler: handleTitleClick
  colorField*:
    eventListeners:
      click:
        handler: handleColorFieldClick
  fontField*:
    eventListeners:
      click:
        handler: handleFontFieldClick
  typographySelect*:
    eventListeners:
      value-change:
        handler: handleTypographySelectChange
  popover:
    eventListeners:
      close:
        handler: handlePopoverClickOverlay
  form:
    eventListeners:
      form-action:
        handler: handleFormActionClick
  colorDialog:
    eventListeners:
      close:
        handler: handleCloseColorDialog
  colorForm:
    eventListeners:
      form-action:
        handler: handleColorFormActionClick
  typographyDialog:
    eventListeners:
      close:
        handler: handleCloseTypographyDialog
  typographyForm:
    eventListeners:
      form-action:
        handler: handleTypographyFormActionClick
  editableText*:
    eventListeners:
      click:
        handler: handleEditableTextClick
  select*:
    eventListeners:
      value-change:
        handler: handleSelectChange
  editableNumber*:
    eventListeners:
      click:
        handler: handleEditableNumberClick
  imageSelectorField*:
    eventListeners:
      click:
        handler: handleImageSelectorFieldClick
  clearImage*:
    eventListeners:
      click:
        handler: handleClearImage
  imageSelector:
    eventListeners:
      image-selected:
        handler: handleImageSelectorSelection
  cancelImageSelection:
    eventListeners:
      click:
        handler: handleCancelImageSelection
  confirmImageSelection:
    eventListeners:
      click:
        handler: handleConfirmImageSelection
  imageSelectorDialog:
    eventListeners:
      close:
        handler: handleCloseImageSelectorDialog
template:
  - rtgl-view w=f h=f p=md:
      - $if hasContent:
          - $if title:
              - rtgl-text s=lg: ${title}
          - rtgl-view w=f h=f g=md:
              - $for field, i in visibleFields:
                  - $if field.type == 'image':
                      - $if field.editable:
                          - rtgl-view pos=rel:
                              - 'rtgl-view#editableImage${i} cur=pointer style="position: relative;"':
                                  - rvn-file-image br=md w=${field.width} h=${field.height} fileId=${field.fileId} key=${field.fileId}: null
                              - 'input#fileInput${i} type=file accept="${field.accept}" style="display: none;"': null
                        $else:
                          - rvn-file-image br=md w=${field.width} h=${field.height} fileId=${field.fileId} key=${field.fileId}: null
                    $elif field.type == 'text':
                      - rtgl-view:
                          - rtgl-text c=mu-fg: ${field.label}
                          - $if field.editable:
                              - rtgl-view#editableText${field.name} cur=pointer:
                                  - rtgl-text s=${field.size}: ${field.value}
                            $else:
                              - rtgl-text s=${field.size}: ${field.value}
                    $elif field.type == 'select':
                      - rtgl-view:
                          - rtgl-text c=mu-fg: ${field.label}
                          - $if field.editable:
                              - rtgl-select#select${field.name} av=c :selectedValue=field.value :options=field.options: null
                            $else:
                              - rtgl-text: ${field.value}
                    $elif field.type == 'color':
                      - rtgl-view:
                          - $if field.editable:
                              - 'rtgl-view#colorField${i} w=200 h=150 br=md cur=pointer style="background-color: ${field.value}"': null
                            $else:
                              - 'rtgl-view w=200 h=150 br=md style="background-color: ${field.value}"': null
                    $elif field.type == 'font':
                      - rtgl-view:
                          - $if field.editable:
                              - rtgl-view#fontField${i} w=200 h=150 av=c ah=c bgc=bg bc=bo bw=xs br=md cur=pointer:
                                  - 'rtgl-text style="font-family: ${field.fontFamily}, sans-serif; font-size: 60px; text-align: center;"': ${field.previewText}
                              - 'input#fileInput${i} type=file accept=".ttf,.otf,.woff,.woff2,.ttc" style="display: none;"': null
                            $else:
                              - rtgl-view w=200 h=150 av=c ah=c bgc=bg bc=bo bw=xs br=md:
                                  - 'rtgl-text style="font-family: ${field.fontFamily}, sans-serif; font-size: 60px; text-align: center;"': ${field.previewText}
                    $elif field.type == 'typography':
                      - rtgl-view:
                          - rtgl-text c=mu-fg: ${field.label}
                          - $if field.editable:
                              - rtgl-select#typographySelect${i} av=c :selectedValue=field.value :options=field.options: null
                            $else:
                              - rtgl-text: ${field.name}
                    $elif field.type == 'image-selector':
                      - rtgl-view:
                          - rtgl-text c=mu-fg: ${field.label}
                          - $if field.editable:
                              - $if field.fileId:
                                  - rtgl-view d=f g=xs:
                                      - rtgl-view#imageSelectorField${i} cur=pointer br=md:
                                          - rvn-file-image w=200 h=150 fileId=${field.fileId} key=${field.fileId}: null
                                      - rtgl-button#clearImage${i} variant=se size=sm: Clear
                                $else:
                                  - rtgl-view#imageSelectorField${i} w=200 h=150 av=c ah=c bgc=bg bc=bo bw=xs br=md cur=pointer:
                                      - rtgl-text c=mu-fg: Select Image
                            $else:
                              - $if field.fileId:
                                  - rtgl-view br=md:
                                      - rvn-file-image w=200 h=150 fileId=${field.fileId} key=${field.fileId}: null
                                $else:
                                  - rtgl-view w=200 h=150 av=c ah=c bgc=bg bc=bo bw=xs br=md:
                                      - rtgl-text c=mu-fg: No Image
                    $elif field.type == 'number':
                      - rtgl-view:
                          - rtgl-text c=mu-fg: ${field.label}
                          - $if field.editable:
                              - rtgl-view#editableNumber${field.name} cur=pointer:
                                  - rtgl-text s=${field.size}: ${field.value}
                            $else:
                              - rtgl-text s=${field.size}: ${field.value}
                    $elif field.type == 'sounds':
                      - $if field.editable:
                          - rtgl-view pos=rel:
                              - 'rtgl-view#editableAudio${i} cur=pointer style="position: relative;"':
                                  - rvn-waveform-visualizer waveformDataFileId=${field.waveformDataFileId} width=270 height=180 key=${field.waveformDataFileId}: null
                              - 'input#fileInput${i} type=file accept="${field.accept}" style="display: none;"': null
                        $else:
                          - rvn-waveform-visualizer waveformDataFileId=${field.waveformDataFileId} width=270 height=180: null
        $else:
          - rtgl-view w=f h=f av=c ah=c:
              - rtgl-text c=mu-fg s=lg ta=c: ${emptyMessage}
  - rtgl-popover#popover ?open=${popover.isOpen} x=${popover.position.x} y=${popover.position.y} place="be":
      - $if form:
          - rtgl-form#form slot=content :defaultValues=popover.defaultValues :form=form: null
  - rtgl-dialog#colorDialog ?open=${colorDialog.isOpen}:
      - rtgl-view slot=content g=md:
          - rtgl-form#colorForm :defaultValues=colorDialog.defaultValues :form=colorDialog.form w=f: null
  - rtgl-dialog#typographyDialog ?open=${typographyDialog.isOpen}:
      - rtgl-view slot=content g=md:
          - rtgl-form#typographyForm :defaultValues=typographyDialog.defaultValues :form=typographyDialog.form w=f: null
  - rtgl-dialog#imageSelectorDialog ?open=${imageSelectorDialog.isOpen}:
      - rtgl-view slot=content g=md:
          - rvn-image-selector#imageSelector: null
          - rtgl-view d=f g=sm:
              - rtgl-button#cancelImageSelection variant=se: Cancel
              - rtgl-button#confirmImageSelection variant=pr: OK
