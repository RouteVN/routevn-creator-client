elementName: rvn-transforms

viewDataSchema:
  type: object
  properties:
    searchQuery:
      type: string
    isDialogOpen:
      type: boolean
    editMode:
      type: boolean
    editItemId:
      type: string
    dialogDefaultValues:
      type: object
    transformForm:
      type: object
    collapsedIds:
      type: array

refs:
  file-explorer:
    eventListeners:
      data-changed:
        handler: handleDataChanged
      click-item:
        handler: handleFileExplorerSelectionChanged
      dblclick-item:
        handler: handleTransformItemDoubleClick
  groupview:
    eventListeners:
      item-click:
        handler: handleTransformItemClick
      item-dblclick:
        handler: handleTransformItemDoubleClick
      add-click:
        handler: handleAddTransformClick
      search-input:
        handler: handleSearchInput
      item-delete:
        handler: handleItemDelete
  detail-form:
    eventListeners:
      form-change:
        handler: handleFormChange
  transform-dialog:
    eventListeners:
      close:
        handler: handleTransformDialogClose
  transform-form:
    eventListeners:
      action-click:
        handler: handleTransformFormActionClick
      form-change:
        handler: handleTransformFormChange
  delete-warning:
    eventListeners:
      close:
        action: hideDeleteWarning

template:
  - rtgl-view d=h w=f h=f:
      - rtgl-view d=h h=f w=f:
          - rvn-resizable-panel#file-explorer w=300 min-w=200 max-w=500 resize-side="right":
              - rtgl-view slot="content" w=f h=f:
                  - rvn-resource-types .resourceCategory=resourceCategory .selectedResourceId=selectedResourceId:
                  - rvn-file-explorer#fileExplorer .items=flatItems .repositoryTarget=repositoryTarget .contextMenuItems=contextMenuItems .emptyContextMenuItems=emptyContextMenuItems:
          - rtgl-view flex=1 h=f:
              - rvn-group-resources-view#groupview .title=title .resourceType=resourceType .flatGroups=flatGroups .selectedItemId=selectedItemId .searchQuery=searchQuery .collapsedIds=collapsedIds .emptyMessage="No transforms found" .uploadText="Upload Files" .acceptedFileTypes=[] .items=items:
          - rvn-resizable-panel panel-type=detail-panel w=270 min-w=200 max-w=500 resize-side="left":
              - rtgl-view wh=f slot="content":
                  - $if selectedItemId:
                      - rvn-transform-thumbnail .item=selectedItem w=f h=180:
                      - rtgl-form#detail-form key=${selectedItemId} w=f h=f .form=form .defaultValues=defaultValues:
                    $else:
                      - rtgl-view wh=f av=c ah=c bgc=mu-fg:
                          - rtgl-text s=md c=mu-fg: "No selection"
  - "rtgl-dialog#transform-dialog ?open=${isDialogOpen} s=lg":
      - 'rtgl-view slot="content" d=h ah=c g=lg w=f':
          - "$if isDialogOpen":
              - rtgl-view flex=4:
                  - rtgl-form#transform-form .defaultValues=dialogDefaultValues .form=transformForm w=f:
              - rtgl-view flex=6:
                  - rtgl-text: Preview
                  - 'rtgl-view w=f bgc=fg pos=rel style="aspect-ratio: 16/9;"':
                      - rtgl-view pos=abs cor=full:
                          - 'div#canvas style="width: 100%; height: 100%;display: flex; background-color: var(--muted);"':
  - rtgl-dialog#delete-warning ?open=${deleteWarningVisible} s=sm:
      - rtgl-view slot=content g=md p=lg d=v:
          - rtgl-text s=lg fw=bold c=dg: Cannot Delete Transform
          - rtgl-text s=sm c=dg: This transform is currently in use and cannot be deleted.
          - rtgl-view d=v g=xs mt=md:
              - rtgl-text s=xs c=mu-fg: Used in ${deleteWarningUsage.count} place(s)
              - rtgl-text s=xs c=mu-fg: Scenes ${deleteWarningUsage.inProps.scene.length} | Layouts ${deleteWarningUsage.inProps.layout.length}
